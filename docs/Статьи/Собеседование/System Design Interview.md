---
share: true
---
## Функциональные требования. (5 минут)
Определяем границы задачи, какую часть системы будем проектировать. 
Это будет одна фича или вся система? Определяем внешний API. Важно договориться с интервьюером о границах решения, чтобы интервью вообще могло уложиться в отведенное время. Запишите юзсейсы на доске, чтобы они всегда были на виду.

## Нефункциональные требования. (5 минут)
Выясняем требования к масштабируемости, доступность производительность. Количество пользователей. Прогноз нагрузки через месяц. Мы строим хайлоад или нет? Объем данных, который предстоит хранить (не забываем про репликацию x3 в большинстве кейсов). Запишите все НФТ на доске, чтобы они всегда были на виду.

Иногда требуется самостоятельно сделать вычисления НФТ. Например, дано:
DAU (daily active users): 1 миллион пользователей
Принимают: 72 сообщения в день
Отправляют: 36 сообщений в день
Одно сообщение: 200 байт

Вычисляем:
72 000 000 / 24 / 60 / 60 = 833 операций чтения в секунду
36 000 000 / 24 / 60 / 60 = 416 операций записи в секунду
200 * 36 000 000 = 6,7 гб данных в день для хранения (без учета репликации)

Полезно знать:
- [[Статьи/Архитектура/Метрики/SLA|SLA]]
- [[Статьи/Архитектура/Метрики/SLO|SLO]]
- [[Статьи/Архитектура/Метрики/SLI|SLI]]

## Верхнеуровневый дизайн. (10 минут)

Набрасываем квадраты на доску по пути happy path выбранного юзкейса. Не нужно сразу стараться расписывать все до микросервиса, делаем крупными мазками. Пользователь, квадрат с БД, сервером приложений, балансировщиком, хранилищем файлов, платежной системой и т.п. Дальше в процессе рассуждений можно уточнять и менять эти квадраты.

Чаще всего данные являются самой важной частью системы, поэтому уделяем им больше внимания на этом этапе. В какую БД положим метаданные? Где будем хранить персональные данные пользователей (с учетом законодательства разных стран)? Какое хранилище используем для медиа файлов? Думаем не только о том как сложить данные, но и насколько удобно будет их потом читать в нужном нам виде. Что чаще происходит, чтение или запись? Исходя из этого можно выбрать тип хранилища. 

Если говорим о [[Статьи/Базы данных/Sharding|шардировании]] БД, то обязательно указываем ключ шардирования, объясняем свое решение.

Если добавляем [[Статьи/Архитектура/Архитектура Систем/Load Balancer|балансировщик]] - всегда уточняем по какому принципу идет балансировка запросов.

Если добавляем кэш - говорим по каким правилам записи туда попадают или оттуда уходят.

Думаем об отказоустойчивости системы, как из за отказа железа не потерять данные или работоспособность всей системы.

Не стоит предлагать конкретные продукты, если вас явно об этом не спрашивают, особенно если вы с ними не работали или не уверены в своих знаниях. Вместо фразы "тут мы используем MongoDB" лучше сказать "тут мы используем NoSQL базу данных".

Полезно знать:
- Применимость SQL vs NoSQL
- [[Статьи/Базы данных/ACID|ACID]]
- [[Статьи/Базы данных/BASE|BASE]]
- Колоночные БД
- Документные БД
- Key-Value БД
- Балансировка нагрузки
- Кэширование
- [[Статьи/Базы данных/CAP Теорема|CAP Теорема]]
- DNS
- Репликация
- [[Статьи/Базы данных/Sharding|Шардирование]]
- Consistent Hashing
- Партиционирование
- Индексирование
- CDN
- [[Статьи/Архитектура/Архитектура Систем/Load Balancer|Load Balancer]]

## Детализация ключевых компонентов. (25 минут)
Проходя по юзкейсу еще раз начинаем уточнять детали. Набрасывать модели данных, исходя из того что нам нужно. Обсуждаем трейдофы различных технологий. Указываем на слабые стороны дизайна и предлагаем их возможные решения. Спрашиваем у интервьюера какие части системы хотим рассмотреть подробнее и их пытаемся описать.

## Частые системы для дизайна
- Сокращатель ссылок
- Социальная сеть (Инстаграм/твиттер)
- Мессенджер
- Сервис по доставке
- Онлайн магазин

## Общие советы
После каждого этапа спрашивайте у интервьюера, в правильном ли направлении мы движемся. "Does it all make sense for now?".

## Ссылки
- <https://sketchboard.me/> - инструмент для совместного редактирования схем
- [Updated easy to remember system design numbers for back-of-the-envelope calculations · GitHub](https://gist.github.com/mwakaba2/8ad25dda8c71fe529855994c70743733) - некоторые цифры для вычисления НФТ
- [GitHub - donnemartin/system-design-primer: Learn how to design large-scale systems. Prep for the system design interview. Includes Anki flashcards.](https://github.com/donnemartin/system-design-primer) - подборки дизайнов систем
- [GitHub - madd86/awesome-system-design: A curated list of awesome System Design (A.K.A. Distributed Systems) resources.](https://github.com/madd86/awesome-system-design) - подборка ссылок для подготовки с системному дизайну

## Видео
- [Владимир Маслов — System Design. Как построить распределенную систему и пройти собеседование - YouTube](https://www.youtube.com/watch?v=popkBBjbAv8)
## Примеры интервью
- [Google system design interview: Design Spotify (with ex-Google EM) - YouTube](https://www.youtube.com/watch?v=_K-eupuDVEc)